<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 | Infinity Countdown</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;700&display=swap');

        :root {
            /* Theme: Cyber (Default) */
            --bg: #030008;
            --primary: #00f2ff;
            --secondary: #ff007a;
            --glass: rgba(255, 255, 255, 0.05);
        }

        /* Royal Theme */
        [data-theme="royal"] {
            --bg: #0a0800;
            --primary: #ffd700;
            --secondary: #ffffff;
        }

        /* Cosmic Theme */
        [data-theme="cosmic"] {
            --bg: #010114;
            --primary: #9d00ff;
            --secondary: #00ffaa;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Space Grotesk', sans-serif; -webkit-tap-highlight-color: transparent; }

        body { background: var(--bg); color: #fff; overflow: hidden; height: 100vh; transition: background 1s ease; }

        canvas { position: fixed; top: 0; left: 0; z-index: 1; cursor: crosshair; }

        .ui { position: relative; z-index: 10; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: none; padding: 20px; text-align: center; }

        .theme-shifter { position: fixed; top: 20px; left: 20px; pointer-events: auto; display: flex; gap: 8px; z-index: 100; }
        .t-btn { width: 35px; height: 35px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; transition: transform 0.3s; }
        .t-btn:active { transform: scale(0.8); }

        .hero { font-size: clamp(5rem, 25vw, 10rem); font-weight: 700; line-height: 0.8; letter-spacing: -4px; margin-bottom: 20px; filter: drop-shadow(0 0 20px var(--primary)); transition: color 0.5s; color: var(--primary); }

        .countdown-row { display: flex; gap: 10px; pointer-events: auto; }
        .box { background: var(--glass); border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(15px); padding: 15px; border-radius: 20px; min-width: 90px; }
        .box .num { display: block; font-size: 2.5rem; font-weight: 700; color: #fff; }
        .box .lbl { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; opacity: 0.6; }

        .vibe-pill { margin-top: 30px; background: rgba(255,255,255,0.07); padding: 12px 25px; border-radius: 100px; display: none; border: 1px solid var(--primary); animation: glowPulse 2s infinite alternate; }
        @keyframes glowPulse { from { box-shadow: 0 0 5px var(--primary); } to { box-shadow: 0 0 20px var(--primary); } }

        .tap-msg { position: fixed; bottom: 30px; opacity: 0.4; font-size: 0.7rem; letter-spacing: 4px; pointer-events: none; width: 100%; text-align: center; }

        .btn-main { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); pointer-events: auto; padding: 15px 40px; border-radius: 50px; background: #fff; color: #000; font-weight: 700; border: none; cursor: pointer; text-transform: uppercase; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 200; display: none; align-items: center; justify-content: center; pointer-events: auto; }
        .modal { background: #111; padding: 30px; border-radius: 30px; width: 90%; max-width: 400px; border: 1px solid var(--primary); }
        textarea { width: 100%; height: 100px; background: #222; border: none; color: #fff; padding: 15px; border-radius: 15px; margin: 15px 0; outline: none; }
    </style>
</head>
<body data-theme="cyber">

    <div class="theme-shifter">
        <div class="t-btn" style="background: #00f2ff;" onclick="setTheme('cyber')"></div>
        <div class="t-btn" style="background: #ffd700;" onclick="setTheme('royal')"></div>
        <div class="t-btn" style="background: #9d00ff;" onclick="setTheme('cosmic')"></div>
    </div>

    <canvas id="fireworksCanvas"></canvas>

    <div class="ui">
        <h1 class="hero" id="year">2026</h1>
        <div class="countdown-row">
            <div class="box"><span class="num" id="h">00</span><span class="lbl">Hrs</span></div>
            <div class="box"><span class="num" id="m">00</span><span class="lbl">Min</span></div>
            <div class="box"><span class="num" id="s">00</span><span class="lbl">Sec</span></div>
        </div>
        <div class="vibe-pill" id="vibe-pill"><span id="vibe-text"></span></div>
    </div>

    <button class="btn-main" onclick="openShare()">Blast it Share âœ¨</button>
    <div class="tap-msg" id="sound-hint">TAP TO UNLOCK AUDIO & IGNITE SKY</div>

    <div class="overlay" id="overlay">
        <div class="modal">
            <h2>Personalize Wish</h2>
            <textarea id="wish-input" placeholder="2026: Be fearless..."></textarea>
            <button class="btn-main" style="position: static; transform: none; width: 100%;" onclick="genShareLink()">Copy Magic Link</button>
            <p onclick="document.getElementById('overlay').style.display='none'" style="text-align: center; margin-top: 20px; opacity: 0.5; cursor: pointer;">Cancel</p>
        </div>
    </div>

<script>
    // --- 1. ENGINE CONSTANTS ---
    const canvas = document.getElementById('fireworksCanvas');
    const ctx = canvas.getContext('2d');
    let theme = 'cyber';
    let particles = [];
    let audioUnlocked = false;

    // Sounds
    const SndPop = new Audio('https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3');
    SndPop.volume = 0.2;

    const colorPalettes = {
        cyber: ['#00f2ff', '#ff007a', '#ffffff', '#7000ff'],
        royal: ['#ffd700', '#ffffff', '#ffeb3b', '#aa8022'],
        cosmic: ['#9d00ff', '#00ffaa', '#ff00e6', '#2b00ff']
    };

    function setTheme(t) {
        theme = t;
        document.body.setAttribute('data-theme', t);
        const p = colorPalettes[t];
        document.documentElement.style.setProperty('--primary', p[0]);
    }

    // --- 2. PHYSICS ENGINE ---
    class Particle {
        constructor(x, y, color, speedX, speedY, flare = false) {
            this.x = x; this.y = y; this.color = color;
            this.speedX = speedX; this.speedY = speedY;
            this.alpha = 1;
            this.friction = flare ? 0.95 : 0.96;
            this.gravity = 0.12;
            this.life = Math.random() * 0.5 + 0.5;
            this.flare = flare;
        }
        draw() {
            ctx.globalAlpha = this.alpha;
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.flare ? 2 : 1.2, 0, Math.PI * 2);
            ctx.fill();
        }
        update() {
            this.speedX *= this.friction;
            this.speedY *= this.friction;
            this.speedY += this.gravity;
            this.x += this.speedX;
            this.y += this.speedY;
            this.alpha -= this.flare ? 0.02 : 0.015;
        }
    }

    function createExplosion(x, y) {
        if (audioUnlocked) { SndPop.currentTime = 0; SndPop.play(); }
        const colors = colorPalettes[theme];
        const color = colors[Math.floor(Math.random() * colors.length)];
        const amount = 80;
        for (let i = 0; i < amount; i++) {
            const angle = Math.random() * Math.PI * 2;
            const velocity = Math.random() * 12;
            particles.push(new Particle(x, y, color, Math.cos(angle)*velocity, Math.sin(angle)*velocity));
        }
    }

    function animate() {
        ctx.fillStyle = `rgba(3, 0, 8, 0.2)`; 
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        particles = particles.filter(p => p.alpha > 0);
        particles.forEach(p => { p.update(); p.draw(); });

        if (Math.random() < 0.03) {
            createExplosion(Math.random() * canvas.width, Math.random() * canvas.height * 0.7);
        }
        requestAnimationFrame(animate);
    }

    // Interactions
    function unlockAudio() {
        audioUnlocked = true;
        document.getElementById('sound-hint').style.display = 'none';
        launchFromUser({ clientX: innerWidth/2, clientY: innerHeight/2 });
    }

    function launchFromUser(e) {
        const x = e.clientX || (e.touches && e.touches[0].clientX);
        const y = e.clientY || (e.touches && e.touches[0].clientY);
        createExplosion(x, y);
    }

    // Sparkle Flare path
    function handleMove(e) {
        const x = e.clientX || (e.touches && e.touches[0].clientX);
        const y = e.clientY || (e.touches && e.touches[0].clientY);
        particles.push(new Particle(x, y, colorPalettes[theme][0], 0, 0, true));
    }

    canvas.addEventListener('mousedown', (e) => { if(!audioUnlocked) unlockAudio(); launchFromUser(e); });
    canvas.addEventListener('mousemove', handleMove);
    canvas.addEventListener('touchstart', (e) => { if(!audioUnlocked) unlockAudio(); launchFromUser(e); });
    canvas.addEventListener('touchmove', handleMove);

    window.addEventListener('resize', () => { canvas.width = innerWidth; canvas.height = innerHeight; });
    canvas.width = innerWidth; canvas.height = innerHeight;
    animate();

    // --- 3. LOGIC ---
    function updateCountdown() {
        const diff = new Date("2026-01-01T00:00:00").getTime() - Date.now();
        if (diff <= 0) {
            document.getElementById('year').innerText = "HAPPY 2026";
            confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 } });
            return;
        }
        document.getElementById('h').innerText = String(Math.floor((diff/1000/60/60)%24)).padStart(2,'0');
        document.getElementById('m').innerText = String(Math.floor((diff/1000/60)%60)).padStart(2,'0');
        document.getElementById('s').innerText = String(Math.floor((diff/1000)%60)).padStart(2,'0');
    }
    setInterval(updateCountdown, 1000);

    // Share & URL system
    function openShare() { document.getElementById('overlay').style.display='flex'; }
    
    function genShareLink() {
        const wish = document.getElementById('wish-input').value;
        const dat = { w: wish, t: theme };
        const code = btoa(JSON.stringify(dat));
        const link = location.origin + location.pathname + '?j=' + code;
        navigator.clipboard.writeText(link);
        alert("Personalized " + theme + " link copied!");
        document.getElementById('overlay').style.display='none';
    }

    // Init state from URL
    const urlP = new URLSearchParams(location.search);
    if(urlP.get('j')) {
        const dec = JSON.parse(atob(urlP.get('j')));
        if(dec.t) setTheme(dec.t);
        if(dec.w) {
            document.getElementById('vibe-text').innerText = dec.w;
            document.getElementById('vibe-pill').style.display = 'block';
        }
    }
</script>
</body>
</html>